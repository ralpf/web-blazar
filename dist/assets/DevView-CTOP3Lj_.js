import{C as t,U as e,l as o}from"./index-gXwsq2TG.js";class DevView extends t{initializeClassFields(){this.logLines=e.FindWithTag(this.root,"logRoot"),this.wsocketOnOf=e.FindWithTag(this.root,"ws-on-off");const t=`ws://${window.location.host}/log`;t.includes("127.0.0.1")||t.includes("localhost")?(o("[WebSocket] disabled for localhost"),this.ws=null):(o(`[WebSocket] will use url: ${t}`),this.ws=new WebSocket(t))}initializeEvents(){this.ws&&(this.ws.onopen=()=>{o("[WebSocket] Connect OK"),this.wsocketOnOf.textContent="on",this.wsocketOnOf.style.backgroundColor="rgba(0, 168, 0, 1)"},this.ws.onclose=()=>{o("[WebSocket] disconnected"),this.wsocketOnOf.textContent="of",this.wsocketOnOf.style.backgroundColor="rgba(168, 0, 0, 1)"},this.ws.onmessage=t=>{const e=String(t.data);o(`[WebSocket] ${e}`);const s=this.logLines.firstElementChild.cloneNode(!0),i=(new Date).toLocaleTimeString("en-GB",{hour12:!1});s.textContent=`${i}: ${e}`,this.logLines.appendChild(s),this.logLines.scrollTop=this.logLines.scrollHeight},window.addEventListener("beforeunload",()=>this.ws?.close()))}}export{DevView};
